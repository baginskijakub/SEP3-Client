@page "/RideCompletion/{rideId:int}"
//not sure if ^ works
@using WebApp.Shared.Components.Buttons
@using WebApp.Shared.Components
@using WebApp.Shared.Components.Ride
@using HttpClients.ClientInterfaces
@using Ride = Domain.Models.Ride
@using Domain.DTOs
@inject IRideService rideService

<div class="find-rides-page-wrapper">
    <div class="home-page-titles">
        <h1 class="title-primary">Youâ€™re almost there</h1>
        <h5 class="title-secondary">Please insert your data so the driver can contact you.</h5>
    </div>

    <div class="ride-completion-input-wrapper">
        <div class="ride-completion-input-inner">
            <p class="caption">Name</p>
            <input class="ride-completion-input" type="text" placeholder="Insert your name" autocomplete="off" @bind="name"/>
        </div>
        <div class="ride-completion-input-inner">
            <p class="caption">Phone number</p>
            <input class="ride-completion-input" type="text" placeholder="Insert your phone number" autocomplete="off" @bind="telNo"/>
        </div>
        <SecondaryButton Text="Send to driver" hasArrow="true" OnClickFunction="OnCompletion"></SecondaryButton>
    </div>
    <div>
        @if (ride != null)
        {
            <RideDetailed Time="@ride.StartDate.GetDateString()" Driver="@ride.Driver" RideId="@ride.Id" StartLocation="@ride.StartLocation.City" EndLocation="@ride.Destination.City"></RideDetailed>
        }
    </div>
    <Footer></Footer>
</div>

@code {
    [Parameter]
    public int RideId { get; set; }
    public Ride? ride { get; set; }
    public String name { get; set; }
    public String telNo  { get; set; }
    
    protected override async Task OnInitializedAsync()
    {

        ride = await rideService.GetRideById(RideId);
    }
    
    public void OnCompletion()
    {
         rideService.JoinRide(new JoinRideDto() { RideId = RideId, Name = name, Phone = telNo });
    }
}